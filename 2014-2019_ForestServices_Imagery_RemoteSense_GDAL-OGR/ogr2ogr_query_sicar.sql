#!/bin/sh

while read line 	

do 

	echo $line

ogr2ogr -f "XLSX" -update -append  dados_car_mun_201804_imovel_$line.xlsx PG:"host=10.20.20.144 user=sfb dbname=car_nacional" -sql "SELECT     municipio.cod_estado, municipio.nom_municipio, imovel.cod_imovel, imovel.idt_imovel,    to_char(imovel.dat_criacao, 'DD-MM-YYYY') as dat_criacao,     imovel.cod_protocolo,     to_char(imovel.dat_protocolo, 'DD-MM-YYYY') as dat_protocolo,     imovel.flg_migracao,       to_char(imovel.dat_cadastro_estadual, 'DD-MM-YYYY') as dat_cad_estadual,    to_char(imovel.dat_atualizacao, 'DD-MM-YYYY') as dat_atualizacao,    imovel.ind_status_imovel,     imovel.ind_tipo_imovel,     imovel.nom_imovel,     municipio.idt_municipio,               imovel.cod_cep,     imovel.ind_zona_localizacao,    documento_imovel.idt_imovel,     documento_imovel.des_denominacao,     documento_imovel.num_area,     documento_imovel.num_matricula_documento,     to_char(documento_imovel.dat_documento, 'DD-MM-YYYY') as dat_documento,     documento_imovel.des_livro,     documento_imovel.des_folha,     documento_imovel.idt_municipio_cartorio,     documento_imovel.des_emissor_documento,     documento_imovel.nom_vendedor,     documento_imovel.nom_declarante,     documento_imovel.des_termo_autodeclaracao,     documento_imovel.des_ccir,     documento_imovel.ind_tipo_documento,     documento_imovel.des_certificacao_incra,     documento_imovel.des_nirf,     documento.idt_documento,     documento.nom_documento,     documento.cod_documento,     documento.idt_tipo_documento,     tipo_documento.nom_tipo_documento,         endereco_imovel.nom_logradouro,     endereco_imovel.num_endereco,     endereco_imovel.des_complemento,     endereco_imovel.nom_bairro,     endereco_imovel.cod_cep,     endereco_imovel.des_telefone,     endereco_imovel.des_email FROM     usr_geocar_aplicacao.imovel,        usr_geocar_aplicacao.documento_imovel,     usr_geocar_aplicacao.rel_documento_imovel_documento,          usr_geocar_aplicacao.documento,     usr_geocar_aplicacao.municipio,     usr_geocar_aplicacao.tipo_documento,     usr_geocar_aplicacao.endereco_imovel  WHERE     imovel.idt_municipio = '$line' AND  imovel.ind_status_imovel in ('AT','PE') AND   imovel.idt_imovel = documento_imovel.idt_imovel AND       rel_documento_imovel_documento.idt_documento_imovel = documento_imovel.idt_documento_imovel AND  documento.idt_documento = rel_documento_imovel_documento.idt_documento AND    municipio.idt_municipio = imovel.idt_municipio AND    tipo_documento.idt_tipo_documento = documento.idt_tipo_documento AND    endereco_imovel.idt_imovel = imovel.idt_imovel " -nln imoveis -nlt POINT

ogr2ogr -f "XLSX" -update -append  dados_car_mun_201804_quadro_$line.xlsx PG:"host=10.20.20.144 user=sfb dbname=car_nacional" -sql "SELECT     municipio.cod_estado, municipio.nom_municipio, imovel.cod_imovel, imovel.idt_imovel,  quadro_area.num_area_reserva_legal_proposta,    quadro_area.num_area_reserva_legal_averbada,    quadro_area.num_area_reserva_legal_aprovada_nao_averbada,    quadro_area.num_area_reserva_legal_minima_lei,    quadro_area.num_area_reserva_legal_excedente_passivo,    quadro_area.num_area_app_area_consolidada,    quadro_area.num_area_app_area_antropizada,    quadro_area.num_area_app_recompor,    quadro_area.num_area_app_vegetacao_nativa,    quadro_area.num_area_reserva_legal_recompor_area_consolidada,    quadro_area.num_area_reserva_legal_recompor_area_antropizada,    quadro_area.num_area_reserva_legal_app,    quadro_area.num_area_reserva_legal_vegetacao_nativa,    quadro_area.num_area_uso_restrito_area_consolidada,    quadro_area.num_area_uso_restrito_area_antropizada,    quadro_area.num_area_uso_restrito_vegetacao_nativa,    quadro_area.num_area_vegetacao_nativa,    quadro_area.num_area_consolidada,    quadro_area.num_area_antropizada,    quadro_area.num_area_pousio,    quadro_area.num_area_sobreposicao_ir,    quadro_area.num_area_uc,    quadro_area.num_area_ti,    quadro_area.num_area_assentamento,    quadro_area.num_area_servidao_administrativa,    quadro_area.num_area_rl_compensada_terceiro_ir,    quadro_area.num_area_rl_compensada_ir_terceiro,    quadro_area.num_area_reserva_legal_recompor,    quadro_area.num_area_uso_restrito_recompor,    quadro_area.num_area_preservacao_permanente,    quadro_area.num_area_uso_restrito,    quadro_area.num_modulo_fiscal,    quadro_area.num_area_imovel,    quadro_area.num_proprietario_possuidor,    quadro_area.num_area_hidrografia,    quadro_area.num_area_reserva_legal,    quadro_area.num_area_reserva_legal_declarada,    quadro_area.num_area_app_banhado,    quadro_area.num_area_app_lago_lagoa_natural,    quadro_area.num_area_app_nascente,    quadro_area.num_area_app_reservatorio,    quadro_area.num_area_app_rio_ate_10,    quadro_area.num_area_app_rio_10_a_50,    quadro_area.num_area_app_rio_50_a_200,    quadro_area.num_area_app_rio_200_a_600,    quadro_area.num_area_app_rio_acima_600,    quadro_area.num_area_app_vereda,    quadro_area.num_area_app_altitude_sup_1800,    quadro_area.num_area_app_declividade_sup_45,    quadro_area.num_area_app_borda_chapada,    quadro_area.num_area_app_topo_morro,    quadro_area.num_area_app_escadinha_lago_lagoa_natural,    quadro_area.num_area_app_escadinha_nascente,    quadro_area.num_area_app_escadinha_rio_ate_10,    quadro_area.num_area_app_escadinha_rio_10_a_50,    quadro_area.num_area_app_escadinha_rio_50_a_200,    quadro_area.num_area_app_escadinha_rio_200_a_600,    quadro_area.num_area_app_escadinha_rio_acima_600,    quadro_area.num_area_app_escadinha_vereda,    quadro_area.num_area_app_manguezal,    quadro_area.num_area_app_restinga,    quadro_area.num_area_uso_restrito_declividade,    quadro_area.num_area_uso_restrito_pantaneira,    quadro_area.num_area_ur_recompor_declividade,    quadro_area.num_area_ur_recompor_pantaneira,    quadro_area.num_area_sa_entorno_reservatorio,    quadro_area.num_area_sa_reservatorio,    quadro_area.num_area_sa_infraestrutura_publica,    quadro_area.num_area_sa_utilidade_publica,    quadro_area.num_area_app_pousio,    quadro_area.num_area_uso_restrito_pousio,    quadro_area.num_area_reserva_legal_pousio,    quadro_area.num_nascente   FROM     usr_geocar_aplicacao.imovel,        usr_geocar_aplicacao.documento_imovel,   usr_geocar_aplicacao.rel_documento_imovel_documento,          usr_geocar_aplicacao.documento,     usr_geocar_aplicacao.municipio,     usr_geocar_aplicacao.tipo_documento,      relatorio.quadro_area WHERE     imovel.idt_municipio = '$line' AND imovel.ind_status_imovel in ('AT','PE') AND    imovel.idt_imovel = documento_imovel.idt_imovel AND       rel_documento_imovel_documento.idt_documento_imovel = documento_imovel.idt_documento_imovel AND  documento.idt_documento = rel_documento_imovel_documento.idt_documento AND    municipio.idt_municipio = imovel.idt_municipio AND    tipo_documento.idt_tipo_documento = documento.idt_tipo_documento AND   imovel.idt_imovel = quadro_area.idt_imovel" -nln quadro_area -nlt POINT

ogr2ogr -f "XLSX" -update -append  dados_car_mun_201804_pessoa_$line.xlsx PG:"host=10.20.20.144 user=sfb dbname=car_nacional" -sql "SELECT     municipio.cod_estado, municipio.nom_municipio, imovel.cod_imovel,  imovel.idt_imovel,    municipio.idt_municipio,      imovel_pessoa.ind_tipo_pessoa,     imovel_pessoa.cod_cpf_cnpj,     imovel_pessoa.nom_completo,     to_char(imovel_pessoa.dat_nascimento, 'DD-MM-YYYY') as dat_nascimento from    usr_geocar_aplicacao.imovel,     usr_geocar_aplicacao.imovel_pessoa,   usr_geocar_aplicacao.municipio   WHERE     imovel.idt_municipio = '$line' AND   imovel.ind_status_imovel in ('AT','PE') AND      imovel_pessoa.idt_imovel = imovel.idt_imovel AND    municipio.idt_municipio = imovel.idt_municipio  " -nln pessoas -nlt POINT

ogr2ogr -f "XLSX" -update -append  dados_car_mun_201804_documento_$line.xlsx PG:"host=10.20.20.144 user=sfb dbname=car_nacional" -sql "SELECT     municipio.cod_estado, municipio.nom_municipio, imovel.cod_imovel, imovel.idt_imovel,   imovel_pessoa.ind_tipo_pessoa,     imovel_pessoa.cod_cpf_cnpj,   rel_documento_imovel_pessoa.idt_rel_documento_imovel_pessoa,     documento_imovel.idt_imovel,     documento_imovel.des_denominacao,     documento_imovel.num_area,     documento_imovel.num_matricula_documento,     to_char(documento_imovel.dat_documento, 'DD-MM-YYYY') as dat_documento,     documento_imovel.des_livro,     documento_imovel.des_folha,     documento_imovel.idt_municipio_cartorio,     documento_imovel.des_emissor_documento,     documento_imovel.nom_vendedor,     documento_imovel.nom_declarante,     documento_imovel.des_termo_autodeclaracao,     documento_imovel.des_ccir,     documento_imovel.ind_tipo_documento,     documento_imovel.des_certificacao_incra,     documento_imovel.des_nirf,     documento.idt_documento,     documento.nom_documento,     documento.cod_documento,     documento.idt_tipo_documento,     tipo_documento.nom_tipo_documento  FROM     usr_geocar_aplicacao.imovel,     usr_geocar_aplicacao.imovel_pessoa,     usr_geocar_aplicacao.documento_imovel,     usr_geocar_aplicacao.rel_documento_imovel_documento,     usr_geocar_aplicacao.rel_documento_imovel_pessoa,     usr_geocar_aplicacao.documento,     usr_geocar_aplicacao.municipio,     usr_geocar_aplicacao.tipo_documento  WHERE     imovel.idt_municipio = '$line' AND   imovel.ind_status_imovel in ('AT','PE') AND    imovel.idt_imovel = documento_imovel.idt_imovel AND    imovel_pessoa.idt_imovel = imovel.idt_imovel AND    rel_documento_imovel_documento.idt_documento_imovel = documento_imovel.idt_documento_imovel AND    rel_documento_imovel_pessoa.idt_documento_imovel = documento_imovel.idt_documento_imovel AND    rel_documento_imovel_pessoa.idt_imovel_pessoa = imovel_pessoa.idt_imovel_pessoa AND    documento.idt_documento = rel_documento_imovel_documento.idt_documento AND    municipio.idt_municipio = imovel.idt_municipio AND    tipo_documento.idt_tipo_documento = documento.idt_tipo_documento " -nln documentos -nlt POINT

ogr2ogr -f "XLSX" -update -append  dados_car_mun_201804_resposta_a_$line.xlsx PG:"host=10.20.20.144 user=sfb dbname=car_nacional" -sql "SELECT    imovel.cod_imovel, imovel.idt_imovel,   resposta_imovel.idt_resposta_pergunta,    left(resposta_pergunta.des_resposta,20) ,    left(pergunta.des_pergunta,20),    imovel.num_area_imovel FROM    usr_geocar_aplicacao.imovel,    usr_geocar_aplicacao.resposta_imovel,    usr_geocar_aplicacao.pergunta,    usr_geocar_aplicacao.resposta_pergunta WHERE      imovel.idt_municipio = '$line' and resposta_imovel.idt_resposta_pergunta IN (1,2,3,4,5,6,7,8,9,10,11,12) AND   imovel.ind_status_imovel IN ('AT','PE') AND   resposta_imovel.idt_imovel = imovel.idt_imovel AND     resposta_pergunta.idt_pergunta = pergunta.idt_pergunta AND   resposta_pergunta.idt_resposta_pergunta = resposta_imovel.idt_resposta_pergunta order by resposta_imovel.idt_resposta_pergunta;" -nln respostas_a -nlt POINT

ogr2ogr -f "XLSX" -update -append  dados_car_mun_201804_resposta_b_$line.xlsx PG:"host=10.20.20.144 user=sfb dbname=car_nacional" -sql "SELECT    imovel.cod_imovel, imovel.idt_imovel,   resposta_imovel.idt_resposta_pergunta,    left(resposta_pergunta.des_resposta,20) ,    left(pergunta.des_pergunta,20),    imovel.num_area_imovel FROM    usr_geocar_aplicacao.imovel,    usr_geocar_aplicacao.resposta_imovel,    usr_geocar_aplicacao.pergunta,    usr_geocar_aplicacao.resposta_pergunta WHERE      imovel.idt_municipio = '$line' and resposta_imovel.idt_resposta_pergunta > 12 AND   imovel.ind_status_imovel IN ('AT','PE') AND   resposta_imovel.idt_imovel = imovel.idt_imovel AND     resposta_pergunta.idt_pergunta = pergunta.idt_pergunta AND   resposta_pergunta.idt_resposta_pergunta = resposta_imovel.idt_resposta_pergunta order by resposta_imovel.idt_resposta_pergunta;" -nln respostas_b -nlt POINT


done < /rede/image03/camara_municipios/brasil_munic_t2.txt
